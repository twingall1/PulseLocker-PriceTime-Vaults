<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PulseLocker</title>

  <style>
    /* ===========================
       THEME VARIABLES
       =========================== */
    :root {
      --bg: #050815;
      --text: #f3f4f6;
      --subtext: #9ca3af;
      --card-bg: #0b1020;
      --border: #1e2638;
      --accent: #16a34a;
      --accent-hover: #1fc556;
      --input-bg: #020617;
      --input-border: #4b5563;
      --status-ok: #4ade80;
      --status-warn: #facc15;
      --status-bad: #f87171;
      --fee: #ef4444;
      --copy-bg: #1e40af;
      --copy-bg-hover: #1d4ed8;
      --min-btn: #facc15;
      --min-btn-hover: #fbbf24;
      --vault-container-bg: #1a2540;
    }

    body.light-theme {
      --bg: #f5f9ff;
      --text: #1a1a1a;
      --subtext: #466078;
      --card-bg: #ffffff;
      --border: #d0e0f0;
      --accent: #16a34a;
      --accent-hover: #0059cc;
      --input-bg: #ffffff;
      --input-border: #b2c8dd;
      --status-ok: #007f3b;
      --status-warn: #b38600;
      --status-bad: #c62828;
      --fee: #c62828;
      --copy-bg: #1f7aec;
      --copy-bg-hover: #0059cc;
      --min-btn: #eab308;
      --min-btn-hover: #ca8a04;
      --vault-container-bg: #e3ecff;
    }

    body {
      margin: 0;
      padding: 16px;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, sans-serif;
      overflow-x: hidden;
    }

    h1, h2 {
      margin-top: 0;
      margin-bottom: 6px;
      font-size: 18px;
      line-height: 1.2;
    }

    /* ===========================
         HEADER (restructured)
       =========================== */
    .header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap; /* allows mobile layout */
      gap: 12px;
      margin-bottom: 12px;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 14px;
      flex: 0 0 auto;
    }

    .header-logo {
      height: 64px;
      width: auto;
    }

    .header-title-block {
      display: flex;
      flex-direction: column;
    }

    .header-title-block div:first-child {
      font-size: 24px;
      font-weight: 700;
    }

    .header-subtitle {
      font-size: 15px;
      color: var(--subtext);
      margin-top: 3px;
    }

    /* === Tabs + Telegram wrapper === */
    .header-tabs {
      display: flex;
      align-items: center;
      gap: 14px;
      flex: 0 0 auto;
    }

    .header-tab {
      font-size: 16px;
      font-weight: 600;
      padding: 6px 14px;
      color: #9ca3af;
      text-decoration: none;
      border-radius: 6px;
      transition: 0.15s ease;
      white-space: nowrap;
    }

    .header-tab:hover {
      color: #60a5fa;
    }

    .active-header-tab {
      background: #1e3a8a;
      border: 1px solid #3b82f6;
      color: white;
    }

    .telegram-btn {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .telegram-icon {
      width: 32px;
      height: 32px;
      opacity: 0.85;
      transition: 0.15s ease;
    }

    .telegram-icon:hover {
      opacity: 1;
      transform: scale(1.1);
    }

    /* ===========================
         WALLET AREA
       =========================== */
    .header-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 4px;
      flex: 0 0 auto;
    }

    .wallet-top-row {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    /* ===========================
         MOBILE HEADER LAYOUT
       =========================== */
    @media (max-width: 700px) {

      /* Row 1: logo + title (already handled by wrapping) */

      /* Row 2: tabs + telegram (inline, no stacking) */
      .header-tabs {
        order: 2;
        flex: 0 0 auto;
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: flex-start;
        gap: 8px;
        width: auto;
        flex-wrap: nowrap;
      }

      .header-tab {
        font-size: 13px !important;
        padding: 4px 8px !important;
      }

      .telegram-icon {
        width: 26px !important;
        height: 26px !important;
      }

      /* Row 3: wallet area (right aligned) */
      .header-right {
        order: 3;
        width: 100%;
        align-items: flex-end;
      }
    }
     /* ===========================
         DASHBOARD + VAULTS
         =========================== */
  
      .three-col-grid {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 16px;
      }
  
      @media (max-width: 1100px) {
        .three-col-grid {
          grid-template-columns: 1fr;
        }
      }
  
      #locksContainerCard {
        background: var(--vault-container-bg);
      }
  
      #locksContainer {
        display: flex;
        flex-direction: column;
        gap: 14px;
      }
  
      .card {
        background: var(--card-bg);
        border-radius: 12px;
        padding: 12px 14px;
        border: 1px solid var(--border);
        margin-bottom: 6px;
        box-shadow: 0 6px 16px rgba(0,0,0,0.25);
      }
  
      /* ===========================
         USER GUIDE SECTION
         =========================== */
      #view-userguide {
        max-width: 800px;
        margin: 0 auto;
        margin-top: 12px;
        display: none; /* router toggles this */
      }
  
      #view-userguide h1 {
        font-size: 26px;
        margin-bottom: 10px;
      }
  
      #view-userguide h2 {
        margin-top: 22px;
        color: #93c5fd;
        font-size: 20px;
      }
  
      #view-userguide a {
        color: #3b82f6;
      }
  
    </style>
  </head>
  
  <body>
  
    <!-- ===========================
         HEADER AREA
         =========================== -->
    <div class="header-row">
  
      <!-- LEFT: Logo + Title -->
      <div class="header-left">
        <img src="assets/logo.png" class="header-logo" />
        <div class="header-title-block">
          <div>PulseLocker</div>
          <div class="header-subtitle">PLS / pDAI / HEX vaults: Unlock at target price or backup time</div>
        </div>
      </div>
  
      <!-- MIDDLE: Tabs + Telegram -->
      <div class="header-tabs">
        <a id="tab-dashboard" href="#dashboard" class="header-tab active-header-tab">Dashboard</a>
        <a id="tab-userguide" href="#userguide" class="header-tab">User Guide</a>
  
        <a href="https://t.me/pulselocker" target="_blank" class="telegram-btn">
          <img src="assets/telegram.png" class="telegram-icon" />
        </a>
      </div>
  
      <!-- RIGHT: Wallet area -->
      <div class="header-right">
        <div class="wallet-top-row">
          <button id="themeToggle">ðŸŒž Day</button>
          <button id="connectBtn">Connect</button>
        </div>
        <div id="walletAddress" class="mono small"></div>
        <div id="networkInfo" class="small"></div>
      </div>
  
    </div>
      <!-- ===========================
       HEADER AREA
       =========================== -->
  <div class="header-row">

    <!-- LEFT: Logo + Title -->
    <div class="header-left">
      <img src="assets/logo.png" class="header-logo" />
      <div class="header-title-block">
        <div>PulseLocker</div>
        <div class="header-subtitle">PLS / pDAI / HEX vaults: Unlock at target price or backup time</div>
      </div>
    </div>

    <!-- MIDDLE: Tabs + Telegram -->
    <div class="header-tabs">
      <a id="tab-dashboard" href="#dashboard" class="header-tab active-header-tab">Dashboard</a>
      <a id="tab-userguide" href="#userguide" class="header-tab">User Guide</a>

      <a href="https://t.me/pulselocker" target="_blank" class="telegram-btn">
        <img src="assets/telegram.png" class="telegram-icon" />
      </a>
    </div>

    <!-- RIGHT: Wallet area -->
    <div class="header-right">
      <div class="wallet-top-row">
        <button id="themeToggle">ðŸŒž Day</button>
        <button id="connectBtn">Connect</button>
      </div>
      <div id="walletAddress" class="mono small"></div>
      <div id="networkInfo" class="small"></div>
    </div>

  </div>

  <!-- ===========================
       DASHBOARD VIEW
       =========================== -->
  <div id="view-dashboard">

    <div class="three-col-grid">

      <!-- LEFT COLUMN -->
      <div class="col-1">
        <div class="card">
          <h2>Create New Vault</h2>
          <form id="createForm">
            <div class="form-row-h">
              <label>Asset:</label>
              <select id="assetSelect">
                <option value="PLS">PLS</option>
                <option value="HEX">HEX</option>
                <option value="pDAI">pDAI</option>
              </select>
            </div>

            <div class="form-row-h">
              <label>Target Price ($):</label>
              <input id="targetPrice" type="number" min="0" step="0.000001" />
            </div>

            <div class="form-row-h">
              <label>Backup Time:</label>
              <input id="unlockDateTime" type="datetime-local" />
            </div>

            <button id="createBtn" type="button">Create Vault</button>
            <div id="createStatus" class="small"></div>
          </form>
        </div>

        <div class="card">
          <h2>Your Vaults</h2>
          <div id="locksContainerCard" class="card">
            <div id="locksContainer"></div>
          </div>

          <div class="form-row-h">
            <input id="manualVaultInput" placeholder="Add existing vault addressâ€¦" class="mono" />
            <button id="addVaultBtn" type="button">Add</button>
          </div>
          <div id="manualAddStatus" class="small"></div>

          <button id="restoreVaultsBtn" type="button">Restore All</button>
        </div>
      </div>

      <!-- CENTER COLUMN -->
      <div class="col-2">
        <div class="card">
          <h2>Global Price Feed</h2>
          <div id="pairAddress" class="mono small"></div>
          <div id="globalPrice" style="margin-top:8px;font-size:22px;"></div>
          <div id="globalPriceRaw" class="small"></div>
        </div>
      </div>

      <!-- RIGHT COLUMN -->
      <div class="col-3">
        <div class="card">
          <h2>About This App</h2>
          <p style="font-size:14px;line-height:1.4;">
            PulseLocker provides immutable price-trigger vaults for PLS / HEX / pDAI.
            Unlock occurs when your chosen price target is hit or when backup time arrives â€”
            whichever happens first.
          </p>
        </div>
      </div>

    </div>
  </div>

  <!-- ===========================
       USER GUIDE VIEW
       =========================== -->
  <div id="view-userguide">

    <h1>User Guide</h1>

    <p>This guide explains how to use PulseLocker vaults, how unlock conditions work, and how to restore previously created vaults.</p>

    <h2>Creating a Vault</h2>
    <p>Select an asset (PLS / HEX / pDAI), choose a target price and a backup unlock time. Once created, vault rules cannot be changed.</p>

    <h2>Unlock Logic</h2>
    <p>A vault unlocks at whichever occurs first:<br/>
       â€“ Target price is reached<br/>
       â€“ Backup time arrives</p>

    <h2>Viewing Other Wallets' Vaults</h2>
    <p>You can add a vault by address to view its progress. Withdraw and rescue buttons will not appear unless the connected wallet is the vault owner.</p>

    <div style="height:40px;"></div>
  </div>

  <!-- ===========================
       JAVASCRIPT (Router + App)
       =========================== -->
  <script src="app.js"></script>
  <script>
    /* =============================================
       SPA ROUTER â€” Dashboard / User Guide
       ============================================= */
    function applyView(view) {
      const dash  = document.getElementById("view-dashboard");
      const guide = document.getElementById("view-userguide");

      const tabDash  = document.getElementById("tab-dashboard");
      const tabGuide = document.getElementById("tab-userguide");

      if (view === "userguide") {
        dash.style.display = "none";
        guide.style.display = "block";
        tabDash.classList.remove("active-header-tab");
        tabGuide.classList.add("active-header-tab");
      } else {
        dash.style.display = "block";
        guide.style.display = "none";
        tabGuide.classList.remove("active-header-tab");
        tabDash.classList.add("active-header-tab");
      }
    }

    function updateFromHash() {
      const h = window.location.hash.toLowerCase();
      if (h === "#userguide") applyView("userguide");
      else applyView("dashboard");
    }

    window.addEventListener("DOMContentLoaded", updateFromHash);
    window.addEventListener("hashchange", updateFromHash);
  </script>

</body>
</html>
